#!/bin/bash

echo "ğŸ” DemoTechApp: Post-commit Template Validation"
echo "================================================"

# Check template completeness
echo "ğŸ“‹ Checking template completeness..."

# Required directories
required_dirs=("components" "pages" "templates" "assets" "config" "data-stores" "learning-data" "workflows")

for dir in "${required_dirs[@]}"; do
    if [ ! -d "$dir" ]; then
        echo "âš ï¸  WARNING: Missing directory: $dir"
    else
        echo "âœ… Found directory: $dir"
    fi
done

# Required files
required_files=("package.json" "README.md" "backend-connector.ts" "PROJECT_SCHEMA.md" "PROJECT_STRUCTURE_RULES.md")

for file in "${required_files[@]}"; do
    if [ ! -f "$file" ]; then
        echo "âŒ ERROR: Missing required file: $file"
        exit 1
    else
        echo "âœ… Found file: $file"
    fi
done

# Check backend logic references
echo "ğŸ“‹ Checking backend logic references..."
if grep -q "from '../backend-logic/" backend-connector.ts; then
    echo "âœ… Backend logic properly referenced"
else
    echo "âŒ ERROR: Backend logic not properly referenced!"
    exit 1
fi

# Check for forbidden patterns
echo "ğŸ“‹ Checking for forbidden patterns..."
if find . -name "*.ts" -o -name "*.js" | xargs grep -l "ai-systems\|core-systems\|advanced-features" 2>/dev/null; then
    echo "âŒ ERROR: Backend logic patterns found in project files!"
    echo "   Backend logic should be referenced, not copied."
    exit 1
fi

echo "âœ… DemoTechApp: Template validation passed!"
echo "ğŸ¯ Project template is complete and follows schema" 